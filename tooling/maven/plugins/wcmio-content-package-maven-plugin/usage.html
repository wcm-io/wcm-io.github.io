<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 from src/site/markdown/usage.md.vm at 2021-09-03

 | Rendered using Apache Maven Default Skin
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.2" />
    <title>Content Package Maven Plugin &#x2013; Content Package Maven Plugin Usage</title>
    <link rel="stylesheet" href="./css/maven-base.css" />
    <link rel="stylesheet" href="./css/maven-theme.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
  </head>
  <body class="composite">
    <div id="banner">
<div id="bannerLeft">Content Package Maven Plugin
</div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
      <div class="xleft">
        <span id="publishDate">Last Published: 2021-09-03</span>
          &#xA0;| <span id="projectVersion">Version: 1.8.5-SNAPSHOT</span>
      </div>
      <div class="xright"><a href="./" title="Content Package Maven Plugin">Content Package Maven Plugin</a>      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
       <h5>Parent Project</h5>
    <ul>
     <li class="none"><a href="../../index.html" title="Maven Tooling">Maven Tooling</a></li>
    </ul>
       <h5>Project Documentation</h5>
    <ul>
     <li class="collapsed"><a href="project-info.html" title="Project Information">Project Information</a></li>
     <li class="collapsed"><a href="project-reports.html" title="Project Reports">Project Reports</a></li>
    </ul>
      <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
      </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
<h1>Content Package Maven Plugin Usage</h1>
<p>Examples for using the plugin.</p><section><section>
<h3><a name="Building_content_packages"></a>Building content packages</h3>
<p>Required steps:</p>
<ul>

<li>Create a separate maven project for the content package and set the packaging type to <code>content-package</code>.</li>
<li>Define the package filters either via the <code>filters</code> plugin property or a predefined filter.xml references via <code>filterSource</code> property.</li>
<li>Set <code>name</code> and <code>group</code> properties for the content package</li>
<li>Make sure the content of the jcr_root folder for the package is copied to the <code>target/classes</code> folder, or you specify an alternative <code>builtContentDirectory</code>.</li>
</ul>
<p>Examples from the wcm.io Sample application:</p>
<ul>

<li><a class="externalLink" href="https://github.com/wcm-io/wcm-io-samples/tree/develop/sample-content">Content package with sample content</a></li>
<li><a class="externalLink" href="https://github.com/wcm-io/wcm-io-samples/tree/develop/complete">Content package for application deployment</a></li>
</ul></section><section>
<h3><a name="Install_single_content_package_from_filesystem"></a>Install single content package from filesystem</h3>

<div class="source">
<div class="source">
<pre>&lt;plugin&gt;
  &lt;groupId&gt;io.wcm.maven.plugins&lt;/groupId&gt;
  &lt;artifactId&gt;wcmio-content-package-maven-plugin&lt;/artifactId&gt;
  &lt;configuration&gt;
    &lt;serviceURL&gt;http://localhost:4502/crx/packmgr/service&lt;/serviceURL&gt;
    &lt;userId&gt;admin&lt;/userId&gt;
    &lt;password&gt;admin&lt;/password&gt;
    &lt;packageFile&gt;/path/to/content-package.zip&lt;/packageFile&gt;
  &lt;/configuration&gt;
&lt;/plugin&gt;
</pre></div></div>

<p>Command line:</p>

<div class="source">
<div class="source">
<pre>mvn wcmio-content-package:install
</pre></div></div>
</section><section>
<h3><a name="Install_multiple_content_packages_from_maven_repository"></a>Install multiple content packages from maven repository</h3>
<p>This usecase is useful to install hotfix and service pack packages to an AEM instance. The hotfixes have to be uploaded to an internal maven repository before, and can than deployed to any instance via maven using their artifact coordinates. Setting force to false ensures that the packages are installed only once, and not on every run.</p>

<div class="source">
<div class="source">
<pre>&lt;plugin&gt;
  &lt;groupId&gt;io.wcm.maven.plugins&lt;/groupId&gt;
  &lt;artifactId&gt;wcmio-content-package-maven-plugin&lt;/artifactId&gt;
  &lt;configuration&gt;
    &lt;serviceURL&gt;http://localhost:4502/crx/packmgr/service&lt;/serviceURL&gt;
    &lt;userId&gt;admin&lt;/userId&gt;
    &lt;password&gt;admin&lt;/password&gt;
    &lt;!-- Skip upload if hotfix package was already uploaded before --&gt;
    &lt;force&gt;false&lt;/force&gt;
    &lt;packageFiles&gt;
      &lt;packageFile&gt;
        &lt;groupId&gt;groupId&lt;/groupId&gt;
        &lt;artifactId&gt;artifactId-1&lt;/artifactId&gt;
        &lt;version&gt;1.0.0&lt;/version&gt;
        &lt;type&gt;zip&lt;/type&gt;
      &lt;/packageFile&gt;
      &lt;packageFile&gt;
        &lt;groupId&gt;groupId&lt;/groupId&gt;
        &lt;artifactId&gt;artifactId-2&lt;/artifactId&gt;
        &lt;version&gt;1.0.0&lt;/version&gt;
        &lt;type&gt;zip&lt;/type&gt;
      &lt;/packageFile&gt;
    &lt;/packageFiles&gt;
  &lt;/configuration&gt;
&lt;/plugin&gt;
</pre></div></div>

<p>Command line:</p>

<div class="source">
<div class="source">
<pre>mvn wcmio-content-package:install
</pre></div></div>
</section><section>
<h3><a name="Download_content_package_with_unpack_and_excludes"></a>Download content package with unpack and excludes</h3>
<p>This downloads a content package back to the project from where it was uploaded from (using the Adobe <code>content-package-maven-plugin</code>). After download it is unpacked automatically, some files are excluded (not unpacked) and some properties are removed from the unpacked <code>.content.xml</code> files (to avoid unwanted changes in SCM commits when versioning the unpacked package contents).</p>

<div class="source">
<div class="source">
<pre>&lt;plugin&gt;
  &lt;groupId&gt;io.wcm.maven.plugins&lt;/groupId&gt;
  &lt;artifactId&gt;wcmio-content-package-maven-plugin&lt;/artifactId&gt;
  &lt;configuration&gt;
    &lt;serviceURL&gt;http://localhost:4502/crx/packmgr/service&lt;/serviceURL&gt;
    &lt;userId&gt;admin&lt;/userId&gt;
    &lt;password&gt;admin&lt;/password&gt;
    &lt;excludeFiles&gt;
      &lt;exclude&gt;^META-INF/.*&lt;/exclude&gt;
      &lt;!-- exclude renditions that are automatically generated --&gt;
      &lt;exclude&gt;.*/cq5dam\.thumbnail\..*&lt;/exclude&gt;
    &lt;/excludeFiles&gt;
    &lt;excludeProperties&gt;
      &lt;exclude&gt;jcr\:created&lt;/exclude&gt;
      &lt;exclude&gt;jcr\:createdBy&lt;/exclude&gt;
      &lt;exclude&gt;jcr\:lastModified&lt;/exclude&gt;
      &lt;exclude&gt;jcr\:lastModifiedBy&lt;/exclude&gt;
      &lt;exclude&gt;cq\:lastModified&lt;/exclude&gt;
      &lt;exclude&gt;cq\:lastModifiedBy&lt;/exclude&gt;
    &lt;/excludeProperties&gt;
  &lt;/configuration&gt;
&lt;/plugin&gt;
</pre></div></div>

<p>Command line:</p>

<div class="source">
<div class="source">
<pre>mvn -Dvault.unpack=true wcmio-content-package:download
</pre></div></div>
</section><section>
<h3><a name="Run_from_command_line_without_pom.xml_context"></a>Run from command line without pom.xml context</h3>
<p>You can execute the <code>install</code> and <code>download</code> goals also directly from the command line without a pom.xml context. You have to pass all parameters as Java System parameters then as well.</p>
<p>Example for directly installing a package without a pom:</p>

<div class="source">
<div class="source">
<pre>mvn io.wcm.maven.plugins:wcmio-content-package-maven-plugin:${project.properties['releasedVersion.version']}:install \
    -Dvault.file=mypackage.zip \
    -Dvault.serviceURL=http://localhost:4502/crx/packmgr/service
</pre></div></div>

<p>The full list of available parameters (user property names) can be found in the <a href="plugin-info.html">plugin documentation</a>.</p></section></section>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
        Copyright &#169;      2014&#x2013;2021<a href="https://wcm.io">wcm.io</a>.
.      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>