
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2023-11-21
 Rendered using Reflow Maven Skin 1.1.0 (https://github.com/wcm-io/wcm-io-tooling/tree/develop/maven/skins/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

  <head>
    <meta charset="UTF-8" />
    <title>Configuration | wcm.io</title>

    <link rel="shortcut icon" href="https://wcm.io/images/favicon.ico">
    <link rel="apple-touch-icon" href="https://wcm.io/images/favicon-152.png">

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="wcm.io - Libraries and extensions for AEM applications" />
    <meta http-equiv="content-language" content="en" />

    <link href="https://wcm.io/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://wcm.io/css/docs.css" rel="stylesheet" />
    <link href="https://wcm.io/css/reflow-skin.css" rel="stylesheet" />
    <link href="https://wcm.io/css/highlightjs-style-github.min.css" rel="stylesheet" />

    <link href="https://wcm.io/css/lightbox.css" rel="stylesheet" />

    <link href="https://wcm.io/css/site.css" rel="stylesheet" />
    <link href="https://wcm.io/css/print.css" rel="stylesheet" media="print" />


  </head>

  <body class="page-configuration project-io.wcm.dam.asset-service" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../..">wcm.io</a>
          <div class="nav-collapse collapse" id="top-nav-collapse">
            <ul class="nav pull-right">
              <li ><a href="https://github.com/wcm-io" title="GitHub project" class="externalLink">GitHub project</a></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Categories <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li ><a href="../../wcm/" title="WCM">WCM</a></li>
                  <li ><a href="../" title="DAM">DAM</a></li>
                  <li ><a href="../../caconfig/" title="Context-Aware Configuration">Context-Aware Configuration</a></li>
                  <li ><a href="../../handler/" title="Handler">Handler</a></li>
                  <li ><a href="../../sling/" title="Sling Extensions">Sling Extensions</a></li>
                  <li ><a href="../../site-api/" title="Site API">Site API</a></li>
                  <li ><a href="../../testing/" title="Testing">Testing</a></li>
                  <li ><a href="../../samples/" title="Samples">Samples</a></li>
                  <li ><a href="../../tooling/" title="Tooling">Tooling</a></li>
                </ul>
              </li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contribute <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li ><a href="../../contribute.html" title="Contribute">Contribute</a></li>
                  <li ><a href="../../manifest.html" title="Manifest">Manifest</a></li>
                  <li ><a href="https://github.com/wcm-io" title="Issues" class="externalLink">Issues</a></li>
                  <li ><a href="https://wcm-io.atlassian.net/wiki/" title="Wiki" class="externalLink">Wiki</a></li>
                  <li ><a href="../../mailing-lists.html" title="Mailing Lists">Mailing Lists</a></li>
                  <li ><a href="https://github.com/wcm-io" title="Fork on GitHub" class="externalLink">Fork on GitHub</a></li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

  <div class="container">

  <!-- Masthead
  ================================================== -->

  <header>
  <div class="jumbotron subhead">
    <div class="row" id="banner">
      <div class="span12">
        <div class="pull-left">
          <a href="../../" id="bannerLeft"><h1><img src="https://wcm.io/images/favicon-16@3x.png"/> wcm.io</h1></a>
          <p class="lead">Libraries and extensions for AEM applications</p>
        </div>
        <div class="pull-right">
        </div>
      </div>
    </div>
  </div>
    <div>
      <ul class="breadcrumb">
        <li><a href="../../" title="wcm.io">wcm.io</a></li>
        <li class="divider">/</li>
        <li><a href="../" title="DAM">DAM</a></li>
        <li class="divider">/</li>
        <li><a href="./" title="DAM Asset Service">DAM Asset Service</a></li>
        <li class="divider">/</li>
        <li>Configuration</li>
      </ul>
    </div>
  </header>

  <div class="main-body">
  <div class="row">
    <div class="span8">
      <div class="body-content">
<section> 
 <div class="page-header">
  <h2 id="Configuration">Configuration</h2>
 </div> 
 <section> 
  <h3 id="OSGi_configuration">OSGi configuration</h3> 
  <p>The DAM asset service can be configured via the “wcm.io DAM Asset Service” entry in the Felix Web Console.</p> 
  <p>Supported parameters:</p> 
  <ul> 
   <li><b>Asset Selector</b>: Selector for attaching REST service to DAM asset paths.</li> 
   <li><b>Data Version Selector</b>: Selector for attaching REST service to DAM folder for getting data version.</li> 
   <li><b>Data Version Strategy</b>: Strategy for building the data versions (see below)</li> 
   <li><b>Update Interval (sec)</b>: Updating interval for calculating data versions in seconds. If multiple changes to the DAM folders contents are detected within this interval they are collected. This is only used by the ‘aggregated checksum’ strategy.</li> 
   <li><b>DAM paths</b>: List of DAM paths for which the asset service should be active. If not set, the service is active for all paths.</li> 
  </ul> 
  <p>If not path is given it defaults to <code>/content/dam</code>.</p> 
 </section> 
 <section> 
  <h3 id="Data_Version_Strategies">Data Version Strategies</h3> 
  <p>The DAM asset service generates a data version for each configured DAM asset path. The data version is updated whenever an asset was changed within this subtree of DAM. There are multiple strategies to generate such a data version available.</p> 
  <p>Notice on handling data versions within in your application: You should not try to interpret the data version string but take it just as an arbitrary string. You should not compare data versions, it is not guaranteed that the lexical ordering of two data versions matches with the temporal order.</p> 
  <section> 
   <h4 id="timestamp_Data_Version_Strategy_.28default.29">timestamp Data Version Strategy (default)</h4> 
   <p>Simple strategy to generate data versions - on each DAM event a new timestamp is generated and returned as data version. Please be aware that this does not produce stable data versions across a cluster of AEM instances.</p> 
   <p>It should only be used if there is only one AEM instance generating the data version, or some sort of long-stable stickyness is applied on the load balancer.</p> 
  </section> 
  <section> 
   <h4 id="checksum_Data_Version_Strategy">checksum Data Version Strategy</h4> 
   <p>Strategy that generates a checksum bases on all DAM asset's path and last modified dates within the DAM asset folder.</p> 
   <p>The aggregated checksum is built by executing a JCR query using the AEM-predefined OAK index <code>damAssetLucene</code>. Executing the query does not touch the JCR content at all, it only reads JCR path and selected properties from the lucene index. This query is executed max. once during the “update interval”, and only if DAM events occurred since the last checksum generation.</p> 
   <p>This strategy produced consistent data versions across multiple AEM instances.</p> 
   <p>To use this strategy a service use has to be configured, see below.</p> 
  </section> 
 </section> 
 <section> 
  <h3 id="Service_User_Configuration">Service User Configuration</h3> 
  <p>If the ‘checksum’ data version strategy is used the DAM asset service needs a principal-based service user mapping entry like this:</p> 
  <div class="source"> 
   <pre><code>  org.apache.sling.serviceusermapping.impl.ServiceUserMapperImpl.amended-myapp-dam-asset-service
    user.mapping=["io.wcm.dam.asset-service\=[dam-reader-service]"]
</code></pre> 
  </div> 
  <p>The built-in principal <code>dam-reader-service</code> has read access to <code>/content/dam</code>.</p> 
  <p>This configuration is required <b>only on author instances</b>.</p> 
 </section> 
</section>
      </div>
    </div>
    <div class="span4">
      <div id="toc-sidebar">
        <div class="well">
          <ul class="nav nav-list">
            <li class="nav-header">Table of Contents</li>
    <li class="dropdown"><a href="#Configuration" title="Configuration">Configuration <b class="caret"></b></a>
      <ul class="nav nav-list">
    <li><a href="#OSGi_configuration" title="OSGi configuration">OSGi configuration</a>
    <li class="dropdown"><a href="#Data_Version_Strategies" title="Data Version Strategies">Data Version Strategies <b class="caret"></b></a>
      <ul class="nav nav-list">
    <li><a href="#timestamp_Data_Version_Strategy_.28default.29" title="timestamp Data Version Strategy (default)">timestamp Data Version Strategy (default)</a>
    <li><a href="#checksum_Data_Version_Strategy" title="checksum Data Version Strategy">checksum Data Version Strategy</a>
        <li class="divider"></li>
      </ul>
    </li>
    <li><a href="#Service_User_Configuration" title="Service User Configuration">Service User Configuration</a>
        <li class="divider"></li>
      </ul>
    </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  </div>

  </div>

  <!-- Footer
  ================================================== -->
  <footer class="well">
    <div class="container">
      <div class="row">
        <div class="span2 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Main</li>
            <li >
              <a href="../../" title="Home">Home</a>
            </li>
            <li >
              <a href="../../platforms.html" title="Platforms">Platforms</a>
            </li>
            <li >
              <a href="../../maven.html" title="Maven Repositories">Maven Repositories</a>
            </li>
            <li >
              <a href="https://github.com/wcm-io" title="GitHub project" class="externalLink">GitHub project</a>
            </li>
            <li >
              <a href="../../subprojects.html" title="Subprojects">Subprojects</a>
            </li>
            <li >
              <a href="http://www.apache.org/licenses/LICENSE-2.0.txt" title="License" class="externalLink">License</a>
            </li>
            <li >
              <a href="../../commercial-support.html" title="Commercial Support">Commercial Support</a>
            </li>
            <li >
              <a href="https://diva-e.com/en/imprint/" title="Imprint" class="externalLink">Imprint</a>
            </li>
            <li >
              <a href="../../privacy.html" title="Privacy Policy">Privacy Policy</a>
            </li>
          </ul>
        </div>
        <div class="span2 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Categories</li>
            <li >
              <a href="../../wcm/" title="WCM">WCM</a>
            </li>
            <li >
              <a href="../" title="DAM">DAM</a>
            </li>
            <li >
              <a href="../../caconfig/" title="Context-Aware Configuration">Context-Aware Configuration</a>
            </li>
            <li >
              <a href="../../handler/" title="Handler">Handler</a>
            </li>
            <li >
              <a href="../../sling/" title="Sling Extensions">Sling Extensions</a>
            </li>
            <li >
              <a href="../../site-api/" title="Site API">Site API</a>
            </li>
            <li >
              <a href="../../testing/" title="Testing">Testing</a>
            </li>
            <li >
              <a href="../../samples/" title="Samples">Samples</a>
            </li>
            <li >
              <a href="../../tooling/" title="Tooling">Tooling</a>
            </li>
          </ul>
        </div>
        <div class="span2 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Contribute</li>
            <li >
              <a href="../../contribute.html" title="Contribute">Contribute</a>
            </li>
            <li >
              <a href="../../manifest.html" title="Manifest">Manifest</a>
            </li>
            <li >
              <a href="https://github.com/wcm-io" title="Issues" class="externalLink">Issues</a>
            </li>
            <li >
              <a href="https://wcm-io.atlassian.net/wiki/" title="Wiki" class="externalLink">Wiki</a>
            </li>
            <li >
              <a href="../../mailing-lists.html" title="Mailing Lists">Mailing Lists</a>
            </li>
            <li >
              <a href="https://github.com/wcm-io" title="Fork on GitHub" class="externalLink">Fork on GitHub</a>
            </li>
          </ul>
        </div>
        <div class="span3 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Maven documentation</li>
            <li >
              <a href="project-info.html" title="Project Information">Project Information <i class="icon-chevron-right"></i></a>
            </li>
            <li >
              <a href="project-reports.html" title="Project Reports">Project Reports <i class="icon-chevron-right"></i></a>
            </li>
          </ul>
        </div>
        <div class="span3 bottom-description">
          <blockquote>wcm.io is an Open Source project which provides libraries and extensions for AEM-based applications.</blockquote>
        </div>
      </div>
    </div>
  </footer>

  <div class="container subfooter">
    <div class="row">
      <div class="span12">
        <p class="pull-right"><a href="#">Back to top</a></p>
        <p class="copyright">Copyright &copy;2014-2023 <a href="https://wcm.io">wcm.io</a>. All Rights Reserved.</p>
        <p class="version-date"><span class="projectVersion">Version: 1.5.1-SNAPSHOT. </span><span class="publishDate">Last Published: 2023-11-21. </span></p>
      </div>
    </div>
  </div>

  <!-- JavaScript
  ================================================== -->
  <script src="https://wcm.io/js/jquery.min.js"></script>
  <script src="https://wcm.io/js/bootstrap.min.js"></script>
  <script src="https://wcm.io/js/lightbox.min.js"></script>
  <script src="https://wcm.io/js/reflow-scroll.js"></script>
  <script src="https://wcm.io/js/highlight.min.js"></script>


  <script src="https://wcm.io/js/reflow-skin.js"></script>

  </body>
</html>