
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2024-03-06
 Rendered using Reflow Maven Skin 1.1.0 (https://github.com/wcm-io/wcm-io-tooling/tree/develop/maven/skins/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

  <head>
    <meta charset="UTF-8" />
    <title>URL Handler usage | wcm.io</title>

    <link rel="shortcut icon" href="https://wcm.io/images/favicon.ico">
    <link rel="apple-touch-icon" href="https://wcm.io/images/favicon-152.png">

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="wcm.io - Libraries and extensions for AEM applications" />
    <meta http-equiv="content-language" content="en" />

    <link href="https://wcm.io/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://wcm.io/css/docs.css" rel="stylesheet" />
    <link href="https://wcm.io/css/reflow-skin.css" rel="stylesheet" />
    <link href="https://wcm.io/css/highlightjs-style-github.min.css" rel="stylesheet" />

    <link href="https://wcm.io/css/lightbox.css" rel="stylesheet" />

    <link href="https://wcm.io/css/site.css" rel="stylesheet" />
    <link href="https://wcm.io/css/print.css" rel="stylesheet" media="print" />


  </head>

  <body class="page-usage project-io.wcm.handler.url" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../..">wcm.io</a>
          <div class="nav-collapse collapse" id="top-nav-collapse">
            <ul class="nav pull-right">
              <li ><a href="https://github.com/wcm-io" title="GitHub project" class="externalLink">GitHub project</a></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Categories <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li ><a href="../../wcm/" title="WCM">WCM</a></li>
                  <li ><a href="../../caconfig/" title="Context-Aware Configuration">Context-Aware Configuration</a></li>
                  <li ><a href="../" title="Handler">Handler</a></li>
                  <li ><a href="../../sling/" title="Sling Extensions">Sling Extensions</a></li>
                  <li ><a href="../../testing/" title="Testing">Testing</a></li>
                  <li ><a href="../../samples/" title="Samples">Samples</a></li>
                  <li ><a href="../../tooling/" title="Tooling">Tooling</a></li>
                </ul>
              </li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contribute <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li ><a href="../../contribute.html" title="Contribute">Contribute</a></li>
                  <li ><a href="../../manifest.html" title="Manifest">Manifest</a></li>
                  <li ><a href="https://github.com/wcm-io" title="Issues" class="externalLink">Issues</a></li>
                  <li ><a href="https://wcm-io.atlassian.net/wiki/" title="Wiki" class="externalLink">Wiki</a></li>
                  <li ><a href="../../mailing-lists.html" title="Mailing Lists">Mailing Lists</a></li>
                  <li ><a href="https://github.com/wcm-io" title="Fork on GitHub" class="externalLink">Fork on GitHub</a></li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

  <div class="container">

  <!-- Masthead
  ================================================== -->

  <header>
  <div class="jumbotron subhead">
    <div class="row" id="banner">
      <div class="span12">
        <div class="pull-left">
          <a href="../../" id="bannerLeft"><h1><img src="https://wcm.io/images/favicon-16@3x.png"/> wcm.io</h1></a>
          <p class="lead">Libraries and extensions for AEM applications</p>
        </div>
        <div class="pull-right">
        </div>
      </div>
    </div>
  </div>
    <div>
      <ul class="breadcrumb">
        <li><a href="../../" title="wcm.io">wcm.io</a></li>
        <li class="divider">/</li>
        <li><a href="../" title="Handler">Handler</a></li>
        <li class="divider">/</li>
        <li><a href="./" title="URL Handler">URL Handler</a></li>
        <li class="divider">/</li>
        <li>URL Handler usage</li>
      </ul>
    </div>
  </header>

  <div class="main-body">
  <div class="row">
    <div class="span8">
      <div class="body-content">
<section> 
 <div class="page-header">
  <h2 id="URL_Handler_usage">URL Handler usage</h2>
 </div> 
 <section> 
  <h3 id="Building_URLs">Building URLs</h3> 
  <p>The <a href="apidocs/io/wcm/handler/url/UrlHandler.html">URL Handler</a> is a Sling Model and can be adapted either from a request or a resource. It automatically reads the context-specific configuration for the Site URLs based on the resource path of the current request or the path of the resource adapted from.</p> 
  <p>Example:</p> 
  <div class="source"> 
   <pre><code class="language-java">UrlHandler urlHandler = request.adaptTo(UrlHandler.class);

// build externalized resource URL
String url = urlHandler.get(cssPath).buildExternalResourceUrl();

// build content page link with selector and protocol change
String url = urlHandler.get(targetPage).selectors("form")
    .urlMode(UrlModes.FULL_URL_FORCESECURE).buildExternalLinkUrl();
</code></pre> 
  </div> 
  <p>Alternatively you can inject the <code>UrlHandler</code> into your Sling Model using the <code>@Self</code> annotation if the model itself adapts from request or resource.</p> 
  <p>The URL handler uses a “builder pattern” so you can flexibly combine the different URL generation options. See <a href="apidocs/io/wcm/handler/url/UrlBuilder.html">URlBuilder</a> for all options.</p> 
  <p>With the different Enumeration constants from <a href="apidocs/io/wcm/handler/url/UrlModes.html">UrlModes</a> you have fine-grained control how the URLs are externalized in the different modes. You can implement your own UrlModes as well.</p> 
 </section> 
 <section> 
  <h3 id="Configuring_domain_names_for_URL_externalization">Configuring domain names for URL externalization</h3> 
  <p>To make sure that the externalization works properly you have to configure three Parameters in the <a href="../../caconfig/">Context-Aware Configuration</a> for configuration “wcm.io Handler Site URLs” (internal name: <code>io.wcm.handler.url.SiteConfig</code>):</p> 
  <ul> 
   <li><code>siteUrl</code>: Site URL on public access from outside, for non-secure access (HTTP).</li> 
   <li><code>siteUrlSecure</code>: Site URL for public access from outside, for secure access (HTTPS). If not configured, <code>siteUrl</code> is used.</li> 
   <li><code>siteUrlAuthor</code>: Site URL on author instance. If not configured, <code>siteUrl</code> is used.</li> 
  </ul> 
  <p>Site URL is a protocol and hostname, e.g. <code>http://www.mycompany.com</code>.</p> 
  <p>Additionally, you can add a placeholder <code>&lt;auto&gt;</code> to the site URL string. This enables an auto-detection of the Site URL based on the host name that was used when requesting the AEM instance. This is especially useful for AEMaaCS instances where different host names are used for access from public side, and access during functional tests and UI tests executed from Cloud Manager. It is recommended to specify both placeholder <code>&lt;auto&gt;</code> and the actual public URL at the same time - the latter serves as fallback when the auto-detection is not possible. Auto-detection does only work, when the handler is adapted from a <code>SlingHttpServletRequest</code> instance.</p> 
  <p>Example: <code>&lt;auto&gt;http://www.mycompany.com</code></p> 
 </section> 
 <section> 
  <h3 id="Site_Root_detection">Site Root detection</h3> 
  <p>The URL handler provides a Sling Model class <a href="apidocs/io/wcm/handler/url/ui/SiteRoot.html">SiteRoot</a> which provides a simple API to get the current site root either in a HTL script or in another Sling Model. The model can be adapted either from a request or a resource.</p> 
  <p>Example usage in a Sling Model:</p> 
  <div class="source"> 
   <pre><code class="language-java">@Model(adaptables = SlingHttpServletRequest.class)
public class MyModel {

  @Self
  private SiteRoot siteRoot;

  @PostConstruct
  private void activate() {
    // get site root page
    Page rootPage = siteRoot.getRootPage();
  }

}
</code></pre> 
  </div> 
 </section> 
 <section> 
  <h3 id="Configuring_and_tailoring_the_URL_resolving_process">Configuring and tailoring the URL resolving process</h3> 
  <p>Optionally you can provide an OSGi service to specify in more detail the URL resolving needs of your application. For this you have to extend the <a href="apidocs/io/wcm/handler/url/spi/UrlHandlerConfig.html">UrlHandlerConfig</a> class. Via <a href="../../sling/commons/context-aware-services.html">Context-Aware Services</a> you can make sure the SPI customization affects only resources (content pages, DAM assets) that are relevant for your application. Thus it is possible to provide different customizations for different applications running in the same AEM instance.</p> 
  <p>With this you can:</p> 
  <ul> 
   <li>Specify on which hierarchy level the root of your site is located (if not specified the inner-most context-aware configuration context path is used)</li> 
   <li>Detect whether a link to a page has to be switched to HTTPs (e.g. a forms template)</li> 
   <li>Detect whether a page is an integrator template</li> 
   <li>Define the default URL mode to use</li> 
   <li>Defines supported integrator template modes</li> 
  </ul> 
  <p>Example:</p> 
  <div class="source"> 
   <pre><code class="language-java">@Component(service = UrlHandlerConfig.class, property = {
    ContextAwareService.PROPERTY_CONTEXT_PATH_PATTERN + "=^/content/(dam/)?myapp(/.*)?$"
})
public class UrlHandlerConfigImpl extends UrlHandlerConfig {

  public static final int SITE_ROOT_LEVEL = 3;

  @Override
  public int getSiteRootLevel(String contextPath) {
    return SITE_ROOT_LEVEL;
  }

  @Override
  public boolean isSecure(Page page) {
    // check if template has a template that needs HTTPs
  }

}
</code></pre> 
  </div> 
 </section> 
</section>
      </div>
    </div>
    <div class="span4">
      <div id="toc-sidebar">
        <div class="well">
          <ul class="nav nav-list">
            <li class="nav-header">Table of Contents</li>
    <li class="dropdown"><a href="#URL_Handler_usage" title="URL Handler usage">URL Handler usage <b class="caret"></b></a>
      <ul class="nav nav-list">
    <li><a href="#Building_URLs" title="Building URLs">Building URLs</a>
    <li><a href="#Configuring_domain_names_for_URL_externalization" title="Configuring domain names for URL externalization">Configuring domain names for URL externalization</a>
    <li><a href="#Site_Root_detection" title="Site Root detection">Site Root detection</a>
    <li><a href="#Configuring_and_tailoring_the_URL_resolving_process" title="Configuring and tailoring the URL resolving process">Configuring and tailoring the URL resolving process</a>
        <li class="divider"></li>
      </ul>
    </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  </div>

  </div>

  <!-- Footer
  ================================================== -->
  <footer class="well">
    <div class="container">
      <div class="row">
        <div class="span2 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Main</li>
            <li >
              <a href="../../" title="Home">Home</a>
            </li>
            <li >
              <a href="../../platforms.html" title="Platforms">Platforms</a>
            </li>
            <li >
              <a href="../../maven.html" title="Maven Repositories">Maven Repositories</a>
            </li>
            <li >
              <a href="https://github.com/wcm-io" title="GitHub project" class="externalLink">GitHub project</a>
            </li>
            <li >
              <a href="../../subprojects.html" title="Subprojects">Subprojects</a>
            </li>
            <li >
              <a href="http://www.apache.org/licenses/LICENSE-2.0.txt" title="License" class="externalLink">License</a>
            </li>
            <li >
              <a href="../../commercial-support.html" title="Commercial Support">Commercial Support</a>
            </li>
            <li >
              <a href="https://diva-e.com/en/imprint/" title="Imprint" class="externalLink">Imprint</a>
            </li>
            <li >
              <a href="../../privacy.html" title="Privacy Policy">Privacy Policy</a>
            </li>
          </ul>
        </div>
        <div class="span2 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Categories</li>
            <li >
              <a href="../../wcm/" title="WCM">WCM</a>
            </li>
            <li >
              <a href="../../caconfig/" title="Context-Aware Configuration">Context-Aware Configuration</a>
            </li>
            <li >
              <a href="../" title="Handler">Handler</a>
            </li>
            <li >
              <a href="../../sling/" title="Sling Extensions">Sling Extensions</a>
            </li>
            <li >
              <a href="../../testing/" title="Testing">Testing</a>
            </li>
            <li >
              <a href="../../samples/" title="Samples">Samples</a>
            </li>
            <li >
              <a href="../../tooling/" title="Tooling">Tooling</a>
            </li>
          </ul>
        </div>
        <div class="span2 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Contribute</li>
            <li >
              <a href="../../contribute.html" title="Contribute">Contribute</a>
            </li>
            <li >
              <a href="../../manifest.html" title="Manifest">Manifest</a>
            </li>
            <li >
              <a href="https://github.com/wcm-io" title="Issues" class="externalLink">Issues</a>
            </li>
            <li >
              <a href="https://wcm-io.atlassian.net/wiki/" title="Wiki" class="externalLink">Wiki</a>
            </li>
            <li >
              <a href="../../mailing-lists.html" title="Mailing Lists">Mailing Lists</a>
            </li>
            <li >
              <a href="https://github.com/wcm-io" title="Fork on GitHub" class="externalLink">Fork on GitHub</a>
            </li>
          </ul>
        </div>
        <div class="span3 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Maven documentation</li>
            <li >
              <a href="project-info.html" title="Project Information">Project Information <i class="icon-chevron-right"></i></a>
            </li>
            <li >
              <a href="project-reports.html" title="Project Reports">Project Reports <i class="icon-chevron-right"></i></a>
            </li>
          </ul>
        </div>
        <div class="span3 bottom-description">
          <blockquote>wcm.io is an Open Source project which provides libraries and extensions for AEM-based applications.</blockquote>
        </div>
      </div>
    </div>
  </footer>

  <div class="container subfooter">
    <div class="row">
      <div class="span12">
        <p class="pull-right"><a href="#">Back to top</a></p>
        <p class="copyright">Copyright &copy;2014-2024 <a href="https://wcm.io">wcm.io</a>. All Rights Reserved.</p>
        <p class="version-date"><span class="projectVersion">Version: 2.0.1-SNAPSHOT. </span><span class="publishDate">Last Published: 2024-03-06. </span></p>
      </div>
    </div>
  </div>

  <!-- JavaScript
  ================================================== -->
  <script src="https://wcm.io/js/jquery.min.js"></script>
  <script src="https://wcm.io/js/bootstrap.min.js"></script>
  <script src="https://wcm.io/js/lightbox.min.js"></script>
  <script src="https://wcm.io/js/reflow-scroll.js"></script>
  <script src="https://wcm.io/js/highlight.min.js"></script>


  <script src="https://wcm.io/js/reflow-skin.js"></script>

  </body>
</html>