
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2021-04-28
 Rendered using Reflow Maven Skin 1.1.0 (https://github.com/wcm-io/wcm-io-tooling/tree/develop/maven/skins/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

  <head>
    <meta charset="UTF-8" />
    <title>RichText Handler Usage | RichText Handler</title>

    <link rel="shortcut icon" href="https://wcm.io/images/favicon.ico">
    <link rel="apple-touch-icon" href="https://wcm.io/images/favicon-152.png">

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="wcm.io - Libraries and extensions for AEM applications" />
    <meta http-equiv="content-language" content="en" />

    <link href="https://wcm.io/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://wcm.io/css/docs.css" rel="stylesheet" />
    <link href="https://wcm.io/css/reflow-skin.css" rel="stylesheet" />
    <link href="https://wcm.io/css/highlightjs-style-github.min.css" rel="stylesheet" />

    <link href="https://wcm.io/css/lightbox.css" rel="stylesheet" />

    <link href="https://wcm.io/css/site.css" rel="stylesheet" />
    <link href="https://wcm.io/css/print.css" rel="stylesheet" media="print" />


  </head>

  <body class="page-usage project-io.wcm.handler.richtext" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../..">wcm.io</a>
          <div class="nav-collapse collapse" id="top-nav-collapse">
            <ul class="nav pull-right">
              <li ><a href="https://github.com/wcm-io" title="GitHub project" class="externalLink">GitHub project</a></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Categories <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li ><a href="../../wcm/" title="WCM">WCM</a></li>
                  <li ><a href="../../dam/" title="DAM">DAM</a></li>
                  <li ><a href="../../caconfig/" title="Context-Aware Configuration">Context-Aware Configuration</a></li>
                  <li ><a href="../" title="Handler">Handler</a></li>
                  <li ><a href="../../sling/" title="Sling">Sling</a></li>
                  <li ><a href="../../testing/" title="Testing">Testing</a></li>
                  <li ><a href="../../samples/" title="Samples">Samples</a></li>
                  <li ><a href="../../tooling/" title="Tooling">Tooling</a></li>
                </ul>
              </li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contribute <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li ><a href="../../contribute.html" title="Contribute">Contribute</a></li>
                  <li ><a href="../../manifest.html" title="Manifest">Manifest</a></li>
                  <li ><a href="https://wcm-io.atlassian.net" title="Issues" class="externalLink">Issues</a></li>
                  <li ><a href="https://wcm-io.atlassian.net/wiki/" title="Wiki" class="externalLink">Wiki</a></li>
                  <li ><a href="../../mailing-lists.html" title="Mailing Lists">Mailing Lists</a></li>
                  <li ><a href="https://github.com/wcm-io" title="Fork on GitHub" class="externalLink">Fork on GitHub</a></li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

  <div class="container">

  <!-- Masthead
  ================================================== -->

  <header>
  <div class="jumbotron subhead">
    <div class="row" id="banner">
      <div class="span12">
        <div class="pull-left">
          <a href="../../" id="bannerLeft"><h1><img src="https://wcm.io/images/favicon-16@3x.png"/> wcm.io</h1></a>
          <p class="lead">Libraries and extensions for AEM applications</p>
        </div>
        <div class="pull-right">
        </div>
      </div>
    </div>
  </div>
    <div>
      <ul class="breadcrumb">
        <li><a href="../../" title="wcm.io">wcm.io</a></li>
        <li class="divider">/</li>
        <li><a href="../index.html" title="Handler">Handler</a></li>
        <li class="divider">/</li>
        <li><a href="index.html" title="RichText Handler">RichText Handler</a></li>
        <li class="divider">/</li>
        <li>RichText Handler Usage</li>
      </ul>
    </div>
  </header>

  <div class="main-body">
  <div class="row">
    <div class="span8">
      <div class="body-content">
<section> 
 <div class="page-header">
  <h2 id="RichText_Handler_Usage">RichText Handler Usage</h2>
 </div> 
 <p>The <a href="apidocs/io/wcm/handler/richtext/RichTextHandler.html">RichText Handler</a> is a Sling Model and can be adapted either from a request or a resource. It automatically reads the context-specific configuration for the Site URLs of the <a href="../url/">URL Handler</a> based on the resource path of the current request or the path of the resource adapted from.</p> 
 <section> 
  <h3 id="Build_rich_text">Build rich text</h3> 
  <p>To build the markup of a rich text stored in repository:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>RichTextHandler richTextHandler = request.adaptTo(RichTextHandler.class);

// build markup for richtext stored in current resource
String markup = richTextHandler.get(resource).buildMarkup();

// build markup for richtext passed as string
String markup = richTextHandler.get(richTextString).buildMarkup();
</pre> 
   </div> 
  </div> 
 </section> 
 <section> 
  <h3 id="Rich_text_properties_in_resource">Rich text properties in resource</h3> 
  <p>When the rich text is stored in a resource the property names used by the rich text in-place editor have to be used:</p> 
  <ul> 
   <li><code>text</code>: Property for storing the rich text XHTML markup</li> 
   <li><code>textIsRich</code>: Denotes if the text property contains rich text (true) or plain text (false)</li> 
  </ul> 
 </section> 
 <section> 
  <h3 id="Build_HTML_from_plain_text">Build HTML from plain text</h3> 
  <p>To render plain text with line breaks as HTML with <code>&lt;br/&gt;</code>-Elements:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>RichTextHandler richTextHandler = request.adaptTo(RichTextHandler.class);

// build markup for plain text with line breakds passed as string
String markup = richTextHandler.get(plainTextString).textMode(TextMode.PLAIN).buildMarkup();
</pre> 
   </div> 
  </div> 
 </section> 
 <section> 
  <h3 id="Using_rich_text_in_HTL.2FSightly_template">Using rich text in HTL/Sightly template</h3> 
  <p>To resolve a rich text inside a HTL template you can use a generic Sling Model for calling the handler:</p> 
  <ul> 
   <li><a href="apidocs/io/wcm/handler/richtext/ui/ResourceRichText.html">ResourceRichText</a> - for rendering rich text</li> 
   <li><a href="apidocs/io/wcm/handler/richtext/ui/ResourceMultilineText.html">ResourceMultilineText</a> - for converting line breaks in plain text</li> 
  </ul> 
  <p>HTL template example:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>&lt;sly data-sly-use.richtext="io.wcm.handler.richtext.ui.ResourceRichText"/&gt;
&lt;div&gt;
  ${richtext.markup @ context='html'}
&lt;/div&gt;
&lt;sly data-sly-use.templates="core/wcm/components/commons/v1/templates.html"
    data-sly-call="${templates.placeholder @ isEmpty=!richtext.valid}"&gt;&lt;/sly&gt;
</pre> 
   </div> 
  </div> 
 </section> 
 <section> 
  <h3 id="Configuring_and_tailoring_the_rich_text_processing">Configuring and tailoring the rich text processing</h3> 
  <p>Optionally you can provide an OSGi service to specify in more detail the rich text processing needs of your application. For this you have to extend the <a href="apidocs/io/wcm/handler/richtext/spi/RichTextHandlerConfig.html">RichTextHandlerConfig</a> class. Via <a href="../../sling/commons/context-aware-services.html">Context-Aware Services</a> you can make sure the SPI customization affects only resources (content pages, DAM assets) that are relevant for your application. Thus it is possible to provide different customizations for different applications running in the same AEM instance.</p> 
  <p>With this you can:</p> 
  <ul> 
   <li>Define additional or alternative <a href="apidocs/io/wcm/handler/richtext/util/RewriteContentHandler.html">RewriteContentHandler</a> implementations that rewrite the rich text fragment before rendering it to the page</li> 
  </ul> 
  <p>Example:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>@Component(service = RichTextHandlerConfig.class, property = {
    ContextAwareService.PROPERTY_CONTEXT_PATH_PATTERN + "=^/content/(dam/)?myapp(/.*)?$"
})
public class RichTextHandlerConfigImpl extends RichTextHandlerConfig {

  private static final List&lt;Class&lt;? extends RewriteContentHandler&gt;&gt; REWRITE_CONTENT_HANDLERS
      = ImmutableList.&lt;Class&lt;? extends RewriteContentHandler&gt;&gt;of(
      DefaultRewriteContentHandler.class, MyCustomRewriteContentHandler.class);

  @Override
  public List&lt;Class&lt;? extends RewriteContentHandler&gt;&gt; getRewriteContentHandlers() {
    return REWRITE_CONTENT_HANDLERS;
  }

}
</pre> 
   </div> 
  </div> 
 </section> 
</section>
      </div>
    </div>
    <div class="span4">
      <div id="toc-sidebar">
        <div class="well">
          <ul class="nav nav-list">
            <li class="nav-header">Table of Contents</li>
    <li class="dropdown"><a href="#RichText_Handler_Usage" title="RichText Handler Usage">RichText Handler Usage <b class="caret"></b></a>
      <ul class="nav nav-list">
    <li><a href="#Build_rich_text" title="Build rich text">Build rich text</a>
    <li><a href="#Rich_text_properties_in_resource" title="Rich text properties in resource">Rich text properties in resource</a>
    <li><a href="#Build_HTML_from_plain_text" title="Build HTML from plain text">Build HTML from plain text</a>
    <li><a href="#Using_rich_text_in_HTL.2FSightly_template" title="Using rich text in HTL/Sightly template">Using rich text in HTL/Sightly template</a>
    <li><a href="#Configuring_and_tailoring_the_rich_text_processing" title="Configuring and tailoring the rich text processing">Configuring and tailoring the rich text processing</a>
        <li class="divider"></li>
      </ul>
    </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  </div>

  </div>

  <!-- Footer
  ================================================== -->
  <footer class="well">
    <div class="container">
      <div class="row">
        <div class="span2 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Main</li>
            <li >
              <a href="../../" title="Home">Home</a>
            </li>
            <li >
              <a href="../../platforms.html" title="Platforms">Platforms</a>
            </li>
            <li >
              <a href="../../maven.html" title="Maven Repositories">Maven Repositories</a>
            </li>
            <li >
              <a href="https://github.com/wcm-io" title="GitHub project" class="externalLink">GitHub project</a>
            </li>
            <li >
              <a href="../../subprojects.html" title="Subprojects">Subprojects</a>
            </li>
            <li >
              <a href="../../license.html" title="License">License</a>
            </li>
            <li >
              <a href="../../commercial-support.html" title="Commercial Support">Commercial Support</a>
            </li>
            <li >
              <a href="../../imprint.html" title="Imprint">Imprint</a>
            </li>
            <li >
              <a href="../../privacy.html" title="Privacy Policy">Privacy Policy</a>
            </li>
          </ul>
        </div>
        <div class="span2 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Categories</li>
            <li >
              <a href="../../wcm/" title="WCM">WCM</a>
            </li>
            <li >
              <a href="../../dam/" title="DAM">DAM</a>
            </li>
            <li >
              <a href="../../caconfig/" title="Context-Aware Configuration">Context-Aware Configuration</a>
            </li>
            <li >
              <a href="../" title="Handler">Handler</a>
            </li>
            <li >
              <a href="../../sling/" title="Sling">Sling</a>
            </li>
            <li >
              <a href="../../testing/" title="Testing">Testing</a>
            </li>
            <li >
              <a href="../../samples/" title="Samples">Samples</a>
            </li>
            <li >
              <a href="../../tooling/" title="Tooling">Tooling</a>
            </li>
          </ul>
        </div>
        <div class="span2 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Contribute</li>
            <li >
              <a href="../../contribute.html" title="Contribute">Contribute</a>
            </li>
            <li >
              <a href="../../manifest.html" title="Manifest">Manifest</a>
            </li>
            <li >
              <a href="https://wcm-io.atlassian.net" title="Issues" class="externalLink">Issues</a>
            </li>
            <li >
              <a href="https://wcm-io.atlassian.net/wiki/" title="Wiki" class="externalLink">Wiki</a>
            </li>
            <li >
              <a href="../../mailing-lists.html" title="Mailing Lists">Mailing Lists</a>
            </li>
            <li >
              <a href="https://github.com/wcm-io" title="Fork on GitHub" class="externalLink">Fork on GitHub</a>
            </li>
          </ul>
        </div>
        <div class="span3 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Maven documentation</li>
            <li >
              <a href="project-info.html" title="Project Information">Project Information <i class="icon-chevron-right"></i></a>
            </li>
            <li >
              <a href="project-reports.html" title="Project Reports">Project Reports <i class="icon-chevron-right"></i></a>
            </li>
          </ul>
        </div>
        <div class="span3 bottom-description">
          <blockquote>wcm.io is an Open Source project which provides libraries and extensions for AEM-based applications.</blockquote>
        </div>
      </div>
    </div>
  </footer>

  <div class="container subfooter">
    <div class="row">
      <div class="span12">
        <p class="pull-right"><a href="#">Back to top</a></p>
        <p class="copyright">Copyright &copy;2014-2021 <a href="https://wcm.io">wcm.io</a>. All Rights Reserved.</p>
        <p class="version-date"><span class="projectVersion">Version: 1.5.3-SNAPSHOT. </span><span class="publishDate">Last Published: 2021-04-28. </span></p>
      </div>
    </div>
  </div>

  <!-- JavaScript
  ================================================== -->
  <script src="https://wcm.io/js/jquery.min.js"></script>
  <script src="https://wcm.io/js/bootstrap.min.js"></script>
  <script src="https://wcm.io/js/lightbox.min.js"></script>
  <script src="https://wcm.io/js/reflow-scroll.js"></script>
  <script src="https://wcm.io/js/highlight.min.js"></script>


  <script src="https://wcm.io/js/reflow-skin.js"></script>

  </body>
</html>