
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2022-01-10
 Rendered using Reflow Maven Skin 1.1.0 (https://github.com/wcm-io/wcm-io-tooling/tree/develop/maven/skins/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

  <head>
    <meta charset="UTF-8" />
    <title>Deploy and configure Context-Aware Configuration in AEM | Context-Aware Configuration</title>

    <link rel="shortcut icon" href="https://wcm.io/images/favicon.ico">
    <link rel="apple-touch-icon" href="https://wcm.io/images/favicon-152.png">

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="wcm.io - Libraries and extensions for AEM applications" />
    <meta http-equiv="content-language" content="en" />

    <link href="https://wcm.io/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://wcm.io/css/docs.css" rel="stylesheet" />
    <link href="https://wcm.io/css/reflow-skin.css" rel="stylesheet" />
    <link href="https://wcm.io/css/highlightjs-style-github.min.css" rel="stylesheet" />

    <link href="https://wcm.io/css/lightbox.css" rel="stylesheet" />

    <link href="https://wcm.io/css/site.css" rel="stylesheet" />
    <link href="https://wcm.io/css/print.css" rel="stylesheet" media="print" />


  </head>

  <body class="page-deploy-configure-caconfig-in-aem project-io.wcm.caconfig.parent" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../..">wcm.io</a>
          <div class="nav-collapse collapse" id="top-nav-collapse">
            <ul class="nav pull-right">
              <li ><a href="https://github.com/wcm-io" title="GitHub project" class="externalLink">GitHub project</a></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Categories <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li ><a href="../../wcm/" title="WCM">WCM</a></li>
                  <li ><a href="../../dam/" title="DAM">DAM</a></li>
                  <li ><a href="../" title="Context-Aware Configuration">Context-Aware Configuration</a></li>
                  <li ><a href="../../handler/" title="Handler">Handler</a></li>
                  <li ><a href="../../sling/" title="Sling">Sling</a></li>
                  <li ><a href="../../testing/" title="Testing">Testing</a></li>
                  <li ><a href="../../samples/" title="Samples">Samples</a></li>
                  <li ><a href="../../tooling/" title="Tooling">Tooling</a></li>
                </ul>
              </li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contribute <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li ><a href="../../contribute.html" title="Contribute">Contribute</a></li>
                  <li ><a href="../../manifest.html" title="Manifest">Manifest</a></li>
                  <li ><a href="https://wcm-io.atlassian.net" title="Issues" class="externalLink">Issues</a></li>
                  <li ><a href="https://wcm-io.atlassian.net/wiki/" title="Wiki" class="externalLink">Wiki</a></li>
                  <li ><a href="../../mailing-lists.html" title="Mailing Lists">Mailing Lists</a></li>
                  <li ><a href="https://github.com/wcm-io" title="Fork on GitHub" class="externalLink">Fork on GitHub</a></li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

  <div class="container">

  <!-- Masthead
  ================================================== -->

  <header>
  <div class="jumbotron subhead">
    <div class="row" id="banner">
      <div class="span12">
        <div class="pull-left">
          <a href="../../" id="bannerLeft"><h1><img src="https://wcm.io/images/favicon-16@3x.png"/> wcm.io</h1></a>
          <p class="lead">Libraries and extensions for AEM applications</p>
        </div>
        <div class="pull-right">
        </div>
      </div>
    </div>
  </div>
    <div>
      <ul class="breadcrumb">
        <li><a href="../../" title="wcm.io">wcm.io</a></li>
        <li class="divider">/</li>
        <li><a href="index.html" title="Context-Aware Configuration">Context-Aware Configuration</a></li>
        <li class="divider">/</li>
        <li>Deploy and configure Context-Aware Configuration in AEM</li>
      </ul>
    </div>
  </header>

  <div class="main-body">
  <div class="row">
    <div class="span8">
      <div class="body-content">
<section> 
 <div class="page-header">
  <h2 id="Deploy_and_configure_Context-Aware_Configuration_in_AEM">Deploy and configure Context-Aware Configuration in AEM</h2>
 </div> 
 <p><a class="externalLink" href="https://sling.apache.org/documentation/bundles/context-aware-configuration/context-aware-configuration.html">Apache Sling Context-Aware Configuration</a> is part of the AEM product since version 6.3. You can also use it in AEM 6.1 or 6.2 by deploying the required bundles and adding some basic configuration. And if you want to use the latest features provided by <a class="externalLink" href="https://wcm.io/caconfig/">wcm.io Context-Aware Configuration</a> you need to deploy some updated bundles from Sling in AEM 6.3 as well.</p> 
 <section> 
  <h3 id="Apache_Sling_Context-Aware_Configuration_Bundles">Apache Sling Context-Aware Configuration Bundles</h3> 
  <p>Links to the latest versions of Apache Sling Context-Aware Configuration bundles:</p> 
  <table border="0" class="bodyTable table table-striped table-hover"> 
   <thead></thead> 
   <tbody> 
    <tr class="a"> 
     <td align="left"><a class="externalLink" href="https://maven-badges.herokuapp.com/maven-central/org.apache.sling/org.apache.sling.caconfig.api">Apache Sling Context-Aware Configuration API</a></td> 
     <td><a class="externalLink" href="https://maven-badges.herokuapp.com/maven-central/org.apache.sling/org.apache.sling.caconfig.api"><img src="https://maven-badges.herokuapp.com/maven-central/org.apache.sling/org.apache.sling.caconfig.api/badge.svg" alt="Maven Central"></a></td> 
    </tr> 
    <tr class="b"> 
     <td align="left"><a class="externalLink" href="https://maven-badges.herokuapp.com/maven-central/org.apache.sling/org.apache.sling.caconfig.spi">Apache Sling Context-Aware Configuration SPI</a></td> 
     <td><a class="externalLink" href="https://maven-badges.herokuapp.com/maven-central/org.apache.sling/org.apache.sling.caconfig.spi"><img src="https://maven-badges.herokuapp.com/maven-central/org.apache.sling/org.apache.sling.caconfig.spi/badge.svg" alt="Maven Central"></a></td> 
    </tr> 
    <tr class="a"> 
     <td align="left"><a class="externalLink" href="https://maven-badges.herokuapp.com/maven-central/org.apache.sling/org.apache.sling.caconfig.impl">Apache Sling Context-Aware Configuration Implementation</a></td> 
     <td><a class="externalLink" href="https://maven-badges.herokuapp.com/maven-central/org.apache.sling/org.apache.sling.caconfig.impl"><img src="https://maven-badges.herokuapp.com/maven-central/org.apache.sling/org.apache.sling.caconfig.impl/badge.svg" alt="Maven Central"></a></td> 
    </tr> 
    <tr class="b"> 
     <td align="left"><a class="externalLink" href="https://maven-badges.herokuapp.com/maven-central/org.apache.sling/org.apache.sling.commons.johnzon">Apache Johnzon Wrapper Library</a></td> 
     <td><a class="externalLink" href="https://maven-badges.herokuapp.com/maven-central/org.apache.sling/org.apache.sling.commons.johnzon"><img src="https://maven-badges.herokuapp.com/maven-central/org.apache.sling/org.apache.sling.commons.johnzon/badge.svg" alt="Maven Central"></a></td> 
    </tr> 
   </tbody> 
  </table> 
 </section> 
 <section> 
  <h3 id="Deploy_Sling_Context-Aware_Configuration_to_AEM_6.1.2F6.2">Deploy Sling Context-Aware Configuration to AEM 6.1/6.2</h3> 
  <p>In AEM 6.1 or AEM 6.2 you need to deploy the latest version of these Sling bundles:</p> 
  <ul> 
   <li><code>org.apache.sling:org.apache.sling.caconfig.api</code></li> 
   <li><code>org.apache.sling:org.apache.sling.caconfig.spi</code></li> 
   <li><code>org.apache.sling:org.apache.sling.caconfig.impl</code></li> 
   <li><code>org.apache.sling:org.apache.sling.commons.johnzon</code></li> 
  </ul> 
  <p>You should apply the same configuration to the Sling Context-Aware Configuration bundles that is present in AEM 6.3 (e.g. for support reading <code>sling:configRef</code> property stored in <code>jcr:content</code> subnodes of AEM content pages and ignoring properties with <code>cq:</code> namespace):</p> 
  <div class="source"> 
   <pre><code>  org.apache.sling.caconfig.resource.impl.def.DefaultContextPathStrategy
    configRefResourceNames=["jcr:content","."]
    configRefPropertyNames=["cq:conf"]

  org.apache.sling.caconfig.resource.impl.def.DefaultConfigurationResourceResolvingStrategy
    fallbackPaths=["/conf/global","/apps","/libs"]
    configCollectionInheritancePropertyNames=["jcr:content/sling:configCollectionInherit", "jcr:content/mergeList","mergeList"]

  org.apache.sling.caconfig.management.impl.ConfigurationManagementSettingsImpl
    ignorePropertyNameRegex=["^(jcr|cq):.+$","^sling:resourceType$"]
    configCollectionPropertiesResourceNames=["jcr:content","."]
</code></pre> 
  </div> 
  <p>If you are using AEM 6.1, make sure to install the latest service pack as well (e.g. AEM 6.1 SP2).</p> 
  <section> 
   <h4 id="Optional_System_user_for_web_console">Optional: System user for web console</h4> 
   <p>By default, the web console plugin for Sling Context-Aware Configuration used the user that is logged into the web console for accessing the repository. Alternatively you can create a system user which has read access to <code>/conf</code> and <code>/content</code> and add an service user mapping for this user (named <code>sling-caconfig</code> in this example):</p> 
   <div class="source"> 
    <pre><code>  org.apache.sling.serviceusermapping.impl.ServiceUserMapperImpl.amended-sling-caconfig
    user.mapping=["org.apache.sling.caconfig.impl\=sling-caconfig"]
</code></pre> 
   </div> 
  </section> 
 </section> 
 <section> 
  <h3 id="Updating_Sling_Context-Aware_Configuration_in_AEM_6.3">Updating Sling Context-Aware Configuration in AEM 6.3</h3> 
  <p>In AEM 6.3 you should check which versions of the bundles mentioned above are already installed. You should update at least the SPI and Impl bundle to the latest version:</p> 
  <ul> 
   <li><code>org.apache.sling:org.apache.sling.caconfig.spi</code></li> 
   <li><code>org.apache.sling:org.apache.sling.caconfig.impl</code></li> 
   <li><code>org.apache.sling:org.apache.sling.commons.johnzon</code></li> 
  </ul> 
  <p>Some configuration for Sling Context-Aware configuration already ships with AEM 6.3, but you should add this additional configuration:</p> 
  <div class="source"> 
   <pre><code>  org.apache.sling.caconfig.resource.impl.def.DefaultConfigurationResourceResolvingStrategy
    fallbackPaths=["/conf/global","/apps","/libs"]
    configCollectionInheritancePropertyNames=["jcr:content/sling:configCollectionInherit", "jcr:content/mergeList","mergeList"]

  org.apache.sling.caconfig.management.impl.ConfigurationManagementSettingsImpl
    ignorePropertyNameRegex=["^(jcr|cq):.+$","^sling:resourceType$"]
    configCollectionPropertiesResourceNames=["jcr:content","."]
</code></pre> 
  </div> 
  <p>If you are using AEM 6.3 and want to write configuration by the Configuration Editor or the Context-Aware Configuration Management API you should also install the <a class="externalLink" href="https://wcm.io/caconfig/extensions/">wcm.io Context-Aware Configuration Extensions</a> and activate the <a class="externalLink" href="https://wcm.io/caconfig/extensions/persistence-strategies.html">“AEM Page” persistence strategy</a> - otherwise you may get subtle problems e.g. when using nested configuration collections.</p> 
 </section> 
 <section> 
  <h3 id="Updating_Sling_Context-Aware_Configuration_in_AEM_6.4">Updating Sling Context-Aware Configuration in AEM 6.4</h3> 
  <p>You do not need to deploy additional bundles in AEM 6.4, but it is recommended to update this configuration:</p> 
  <div class="source"> 
   <pre><code>  org.apache.sling.caconfig.management.impl.ConfigurationManagementSettingsImpl
    ignorePropertyNameRegex=["^(jcr|cq):.+$","^sling:resourceType$"]
    configCollectionPropertiesResourceNames=["jcr:content","."]
</code></pre> 
  </div> 
 </section> 
 <section> 
  <h3 id="AEM_6.5_and_AEM_Cloud_Service">AEM 6.5 and AEM Cloud Service</h3> 
  <p>No special configurations required, everything is up-to-date.</p> 
 </section> 
</section>
      </div>
    </div>
    <div class="span4">
      <div id="toc-sidebar">
        <div class="well">
          <ul class="nav nav-list">
            <li class="nav-header">Table of Contents</li>
    <li class="dropdown"><a href="#Deploy_and_configure_Context-Aware_Configuration_in_AEM" title="Deploy and configure Context-Aware Configuration in AEM">Deploy and configure Context-Aware Configuration in AEM <b class="caret"></b></a>
      <ul class="nav nav-list">
    <li><a href="#Apache_Sling_Context-Aware_Configuration_Bundles" title="Apache Sling Context-Aware Configuration Bundles">Apache Sling Context-Aware Configuration Bundles</a>
    <li class="dropdown"><a href="#Deploy_Sling_Context-Aware_Configuration_to_AEM_6.1.2F6.2" title="Deploy Sling Context-Aware Configuration to AEM 6.1/6.2">Deploy Sling Context-Aware Configuration to AEM 6.1/6.2 <b class="caret"></b></a>
      <ul class="nav nav-list">
    <li><a href="#Optional_System_user_for_web_console" title="Optional: System user for web console">Optional: System user for web console</a>
        <li class="divider"></li>
      </ul>
    </li>
    <li><a href="#Updating_Sling_Context-Aware_Configuration_in_AEM_6.3" title="Updating Sling Context-Aware Configuration in AEM 6.3">Updating Sling Context-Aware Configuration in AEM 6.3</a>
    <li><a href="#Updating_Sling_Context-Aware_Configuration_in_AEM_6.4" title="Updating Sling Context-Aware Configuration in AEM 6.4">Updating Sling Context-Aware Configuration in AEM 6.4</a>
    <li><a href="#AEM_6.5_and_AEM_Cloud_Service" title="AEM 6.5 and AEM Cloud Service">AEM 6.5 and AEM Cloud Service</a>
        <li class="divider"></li>
      </ul>
    </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  </div>

  </div>

  <!-- Footer
  ================================================== -->
  <footer class="well">
    <div class="container">
      <div class="row">
        <div class="span2 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Main</li>
            <li >
              <a href="../../" title="Home">Home</a>
            </li>
            <li >
              <a href="../../platforms.html" title="Platforms">Platforms</a>
            </li>
            <li >
              <a href="../../maven.html" title="Maven Repositories">Maven Repositories</a>
            </li>
            <li >
              <a href="https://github.com/wcm-io" title="GitHub project" class="externalLink">GitHub project</a>
            </li>
            <li >
              <a href="../../subprojects.html" title="Subprojects">Subprojects</a>
            </li>
            <li >
              <a href="http://www.apache.org/licenses/LICENSE-2.0.txt" title="License" class="externalLink">License</a>
            </li>
            <li >
              <a href="../../commercial-support.html" title="Commercial Support">Commercial Support</a>
            </li>
            <li >
              <a href="https://diva-e.com/en/imprint/" title="Imprint" class="externalLink">Imprint</a>
            </li>
            <li >
              <a href="../../privacy.html" title="Privacy Policy">Privacy Policy</a>
            </li>
          </ul>
        </div>
        <div class="span2 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Categories</li>
            <li >
              <a href="../../wcm/" title="WCM">WCM</a>
            </li>
            <li >
              <a href="../../dam/" title="DAM">DAM</a>
            </li>
            <li >
              <a href="../" title="Context-Aware Configuration">Context-Aware Configuration</a>
            </li>
            <li >
              <a href="../../handler/" title="Handler">Handler</a>
            </li>
            <li >
              <a href="../../sling/" title="Sling">Sling</a>
            </li>
            <li >
              <a href="../../testing/" title="Testing">Testing</a>
            </li>
            <li >
              <a href="../../samples/" title="Samples">Samples</a>
            </li>
            <li >
              <a href="../../tooling/" title="Tooling">Tooling</a>
            </li>
          </ul>
        </div>
        <div class="span2 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Contribute</li>
            <li >
              <a href="../../contribute.html" title="Contribute">Contribute</a>
            </li>
            <li >
              <a href="../../manifest.html" title="Manifest">Manifest</a>
            </li>
            <li >
              <a href="https://wcm-io.atlassian.net" title="Issues" class="externalLink">Issues</a>
            </li>
            <li >
              <a href="https://wcm-io.atlassian.net/wiki/" title="Wiki" class="externalLink">Wiki</a>
            </li>
            <li >
              <a href="../../mailing-lists.html" title="Mailing Lists">Mailing Lists</a>
            </li>
            <li >
              <a href="https://github.com/wcm-io" title="Fork on GitHub" class="externalLink">Fork on GitHub</a>
            </li>
          </ul>
        </div>
        <div class="span3 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Maven documentation</li>
            <li >
              <a href="project-info.html" title="Project Information">Project Information <i class="icon-chevron-right"></i></a>
            </li>
            <li >
              <a href="project-reports.html" title="Project Reports">Project Reports <i class="icon-chevron-right"></i></a>
            </li>
          </ul>
        </div>
        <div class="span3 bottom-description">
          <blockquote>wcm.io is an Open Source project which provides libraries and extensions for AEM-based applications.</blockquote>
        </div>
      </div>
    </div>
  </footer>

  <div class="container subfooter">
    <div class="row">
      <div class="span12">
        <p class="pull-right"><a href="#">Back to top</a></p>
        <p class="copyright">Copyright &copy;2014-2022 <a href="https://wcm.io">wcm.io</a>. All Rights Reserved.</p>
        <p class="version-date"><span class="projectVersion">Version: 1.3.5-SNAPSHOT. </span><span class="publishDate">Last Published: 2022-01-10. </span></p>
      </div>
    </div>
  </div>

  <!-- JavaScript
  ================================================== -->
  <script src="https://wcm.io/js/jquery.min.js"></script>
  <script src="https://wcm.io/js/bootstrap.min.js"></script>
  <script src="https://wcm.io/js/lightbox.min.js"></script>
  <script src="https://wcm.io/js/reflow-scroll.js"></script>
  <script src="https://wcm.io/js/highlight.min.js"></script>


  <script src="https://wcm.io/js/reflow-skin.js"></script>

  </body>
</html>