
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2022-12-22
 Rendered using Reflow Maven Skin 1.1.0 (https://github.com/wcm-io/wcm-io-tooling/tree/develop/maven/skins/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

  <head>
    <meta charset="UTF-8" />
    <title>Site API Processor usage | wcm.io</title>

    <link rel="shortcut icon" href="https://wcm.io/images/favicon.ico">
    <link rel="apple-touch-icon" href="https://wcm.io/images/favicon-152.png">

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="wcm.io - Libraries and extensions for AEM applications" />
    <meta http-equiv="content-language" content="en" />

    <link href="https://wcm.io/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://wcm.io/css/docs.css" rel="stylesheet" />
    <link href="https://wcm.io/css/reflow-skin.css" rel="stylesheet" />
    <link href="https://wcm.io/css/highlightjs-style-github.min.css" rel="stylesheet" />

    <link href="https://wcm.io/css/lightbox.css" rel="stylesheet" />

    <link href="https://wcm.io/css/site.css" rel="stylesheet" />
    <link href="https://wcm.io/css/print.css" rel="stylesheet" media="print" />


  </head>

  <body class="page-usage project-io.wcm.site-api.processor" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../..">wcm.io</a>
          <div class="nav-collapse collapse" id="top-nav-collapse">
            <ul class="nav pull-right">
              <li ><a href="https://github.com/wcm-io" title="GitHub project" class="externalLink">GitHub project</a></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Categories <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li ><a href="../../wcm/" title="WCM">WCM</a></li>
                  <li ><a href="../../dam/" title="DAM">DAM</a></li>
                  <li ><a href="../../caconfig/" title="Context-Aware Configuration">Context-Aware Configuration</a></li>
                  <li ><a href="../../handler/" title="Handler">Handler</a></li>
                  <li ><a href="../../sling/" title="Sling Extensions">Sling Extensions</a></li>
                  <li ><a href="../" title="Site API">Site API</a></li>
                  <li ><a href="../../testing/" title="Testing">Testing</a></li>
                  <li ><a href="../../samples/" title="Samples">Samples</a></li>
                  <li ><a href="../../tooling/" title="Tooling">Tooling</a></li>
                </ul>
              </li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contribute <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li ><a href="../../contribute.html" title="Contribute">Contribute</a></li>
                  <li ><a href="../../manifest.html" title="Manifest">Manifest</a></li>
                  <li ><a href="https://github.com/wcm-io" title="Issues" class="externalLink">Issues</a></li>
                  <li ><a href="https://wcm-io.atlassian.net/wiki/" title="Wiki" class="externalLink">Wiki</a></li>
                  <li ><a href="../../mailing-lists.html" title="Mailing Lists">Mailing Lists</a></li>
                  <li ><a href="https://github.com/wcm-io" title="Fork on GitHub" class="externalLink">Fork on GitHub</a></li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

  <div class="container">

  <!-- Masthead
  ================================================== -->

  <header>
  <div class="jumbotron subhead">
    <div class="row" id="banner">
      <div class="span12">
        <div class="pull-left">
          <a href="../../" id="bannerLeft"><h1><img src="https://wcm.io/images/favicon-16@3x.png"/> wcm.io</h1></a>
          <p class="lead">Libraries and extensions for AEM applications</p>
        </div>
        <div class="pull-right">
        </div>
      </div>
    </div>
  </div>
    <div>
      <ul class="breadcrumb">
        <li><a href="../../" title="wcm.io">wcm.io</a></li>
        <li class="divider">/</li>
        <li><a href="../" title="Site API">Site API</a></li>
        <li class="divider">/</li>
        <li><a href="./" title="Site API Processor">Site API Processor</a></li>
        <li class="divider">/</li>
        <li>Site API Processor usage</li>
      </ul>
    </div>
  </header>

  <div class="main-body">
  <div class="row">
    <div class="span8">
      <div class="body-content">
<section> 
 <div class="page-header">
  <h2 id="Site_API_Processor_usage">Site API Processor usage</h2>
 </div> 
 <section> 
  <h3 id="Configuring_built-in_processors">Configuring built-in processors</h3> 
  <p>You can enable the built-in processors by providing an OSGi configuration:</p> 
  <div class="source"> 
   <pre><code>  io.wcm.siteapi.processor.impl.index.IndexProcessor
    enabled=B"true"

  io.wcm.siteapi.processor.impl.content.ContentProcessor
    enabled=B"true"

  io.wcm.siteapi.processor.impl.caconfig.ContextAwareConfigurationProcessor
    enabled=B"true"
</code></pre> 
  </div> 
  <p>For the <code>config</code> processor you can configure which Context-Aware configuration names should be exported:</p> 
  <div class="source"> 
   <pre><code>  io.wcm.siteapi.processor.impl.caconfig.ContextAwareConfigurationExportImpl-XXX
    names=["x.y.z.MyConfig1", "x.y.z.MyConfig2"]
</code></pre> 
  </div> 
  <p>It's a factory configuration, so replace XXX with a project-specific suffix.</p> 
  <p>To ensure a consistent JSON property/element ordering it is recommended to reconfigure the Sling Models Jackson exporter:</p> 
  <div class="source"> 
   <pre><code>  org.apache.sling.models.jacksonexporter.impl.JacksonExporter
    mapping.options=[
      "SerializationFeature.ORDER_MAP_ENTRIES_BY_KEYS\=true",
      "MapperFeature.SORT_PROPERTIES_ALPHABETICALLY\=true"]
</code></pre> 
  </div> 
 </section> 
 <section> 
  <h3 id="Implement_Processor_serving_JSON_objects">Implement Processor serving JSON objects</h3> 
  <p>For most use cases you build your JSON response using Java objects or Map structures. This is supported by using the `JsonObjectProcessor':</p> 
  <div class="source"> 
   <pre><code class="language-java">@Component(service = Processor.class, property = {
    ProcessorConstants.PROPERTY_SUFFIX + "=myprocessor",
    ProcessorConstants.PROPERTY_ENABLED + "=true"
})
public class MyProcessor implements JsonObjectProcessor&lt;MyResponse&gt; {
  @Override
  public @Nullable MyResponse process(@NotNull ProcessorRequestContext context) {
    // implement
  }
}
</code></pre> 
  </div> 
  <p>If you return <code>null</code>, the Site API returns HTTP 404. You can use this e.g. to further validate the request context, page hierarchy or other input parameters to check if the request is valid.</p> 
  <p>If you return an actual object, this is serialized to JSON and returned.</p> 
  <p>It's easy to write unit tests for this type of processor implementations as you can write test against the Java API of the response, and do not have to parse and validate the returned JSON structure.</p> 
  <p>Example implementations:</p> 
  <ul> 
   <li><a class="externalLink" href="https://github.com/wcm-io/io.wcm.site-api.processor/blob/develop/src/main/java/io/wcm/siteapi/processor/impl/index/IndexProcessor.java">IndexProcessor</a></li> 
   <li><a class="externalLink" href="https://github.com/wcm-io/io.wcm.site-api.processor/blob/develop/src/main/java/io/wcm/siteapi/processor/impl/caconfig/ContextAwareConfigurationProcessor.java">ContextAwareConfigurationProcessor</a></li> 
   <li><a class="externalLink" href="https://github.com/wcm-io/io.wcm.site-api.handler/blob/develop/src/main/java/io/wcm/siteapi/handler/processor/impl/navigation/NavigationProcessor.java">NavigationProcessor</a></li> 
  </ul> 
 </section> 
 <section> 
  <h3 id="Implement_Processor_serving_any_response">Implement Processor serving any response</h3> 
  <p>If you need more control about the response, you can implement the <code>SlingHttpServletProcessor</code> interface:</p> 
  <div class="source"> 
   <pre><code class="language-java">@Component(service = Processor.class, property = {
    ProcessorConstants.PROPERTY_SUFFIX + "=myprocessor",
    ProcessorConstants.PROPERTY_ENABLED + "=true"
})
public class MyProcessor implements SlingHttpServletProcessor {
@Override
  public void process(@NotNull ProcessorRequestContext context, @NotNull SlingHttpServletResponse response)
      throws ServletException, IOException {
    // implement
  }
}
</code></pre> 
  </div> 
  <p>In this case you have to take over full control over the servlet response and the data returned.</p> 
  <p>Example implementations:</p> 
  <ul> 
   <li><a class="externalLink" href="https://github.com/wcm-io/io.wcm.site-api.processor/blob/develop/src/main/java/io/wcm/siteapi/processor/impl/content/ContentProcessor.java">ContentProcessor</a></li> 
  </ul> 
 </section> 
 <section> 
  <h3 id="Customize_Context-Aware_Configuration_Mapping">Customize Context-Aware Configuration Mapping</h3> 
  <p>By default, all Context-Aware configuration structures are transformed in a sensible way to JSON structures, including more complex use cases like configuration collections and nested configurations.</p> 
  <p>You can customize tha mapping for individual properties by implementing the interface <code>ContextAwareConfigurationPropertyMapper</code>.</p> 
  <p>Example implementations:</p> 
  <ul> 
   <li><a class="externalLink" href="https://github.com/wcm-io/io.wcm.site-api.processor/blob/develop/src/main/java/io/wcm/siteapi/processor/caconfig/impl/property/JsonRawValuePropertyMapper.java">JsonRawValuePropertyMapper</a></li> 
   <li><a class="externalLink" href="https://github.com/wcm-io/io.wcm.site-api.handler/blob/develop/src/main/java/io/wcm/siteapi/handler/caconfig/impl/property/ContentPathPropertyMapper.java">ContentPathPropertyMapper</a></li> 
  </ul> 
 </section> 
</section>
      </div>
    </div>
    <div class="span4">
      <div id="toc-sidebar">
        <div class="well">
          <ul class="nav nav-list">
            <li class="nav-header">Table of Contents</li>
    <li class="dropdown"><a href="#Site_API_Processor_usage" title="Site API Processor usage">Site API Processor usage <b class="caret"></b></a>
      <ul class="nav nav-list">
    <li><a href="#Configuring_built-in_processors" title="Configuring built-in processors">Configuring built-in processors</a>
    <li><a href="#Implement_Processor_serving_JSON_objects" title="Implement Processor serving JSON objects">Implement Processor serving JSON objects</a>
    <li><a href="#Implement_Processor_serving_any_response" title="Implement Processor serving any response">Implement Processor serving any response</a>
    <li><a href="#Customize_Context-Aware_Configuration_Mapping" title="Customize Context-Aware Configuration Mapping">Customize Context-Aware Configuration Mapping</a>
        <li class="divider"></li>
      </ul>
    </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  </div>

  </div>

  <!-- Footer
  ================================================== -->
  <footer class="well">
    <div class="container">
      <div class="row">
        <div class="span2 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Main</li>
            <li >
              <a href="../../" title="Home">Home</a>
            </li>
            <li >
              <a href="../../platforms.html" title="Platforms">Platforms</a>
            </li>
            <li >
              <a href="../../maven.html" title="Maven Repositories">Maven Repositories</a>
            </li>
            <li >
              <a href="https://github.com/wcm-io" title="GitHub project" class="externalLink">GitHub project</a>
            </li>
            <li >
              <a href="../../subprojects.html" title="Subprojects">Subprojects</a>
            </li>
            <li >
              <a href="http://www.apache.org/licenses/LICENSE-2.0.txt" title="License" class="externalLink">License</a>
            </li>
            <li >
              <a href="../../commercial-support.html" title="Commercial Support">Commercial Support</a>
            </li>
            <li >
              <a href="https://diva-e.com/en/imprint/" title="Imprint" class="externalLink">Imprint</a>
            </li>
            <li >
              <a href="../../privacy.html" title="Privacy Policy">Privacy Policy</a>
            </li>
          </ul>
        </div>
        <div class="span2 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Categories</li>
            <li >
              <a href="../../wcm/" title="WCM">WCM</a>
            </li>
            <li >
              <a href="../../dam/" title="DAM">DAM</a>
            </li>
            <li >
              <a href="../../caconfig/" title="Context-Aware Configuration">Context-Aware Configuration</a>
            </li>
            <li >
              <a href="../../handler/" title="Handler">Handler</a>
            </li>
            <li >
              <a href="../../sling/" title="Sling Extensions">Sling Extensions</a>
            </li>
            <li >
              <a href="../" title="Site API">Site API</a>
            </li>
            <li >
              <a href="../../testing/" title="Testing">Testing</a>
            </li>
            <li >
              <a href="../../samples/" title="Samples">Samples</a>
            </li>
            <li >
              <a href="../../tooling/" title="Tooling">Tooling</a>
            </li>
          </ul>
        </div>
        <div class="span2 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Contribute</li>
            <li >
              <a href="../../contribute.html" title="Contribute">Contribute</a>
            </li>
            <li >
              <a href="../../manifest.html" title="Manifest">Manifest</a>
            </li>
            <li >
              <a href="https://github.com/wcm-io" title="Issues" class="externalLink">Issues</a>
            </li>
            <li >
              <a href="https://wcm-io.atlassian.net/wiki/" title="Wiki" class="externalLink">Wiki</a>
            </li>
            <li >
              <a href="../../mailing-lists.html" title="Mailing Lists">Mailing Lists</a>
            </li>
            <li >
              <a href="https://github.com/wcm-io" title="Fork on GitHub" class="externalLink">Fork on GitHub</a>
            </li>
          </ul>
        </div>
        <div class="span3 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Maven documentation</li>
            <li >
              <a href="project-info.html" title="Project Information">Project Information <i class="icon-chevron-right"></i></a>
            </li>
            <li >
              <a href="project-reports.html" title="Project Reports">Project Reports <i class="icon-chevron-right"></i></a>
            </li>
          </ul>
        </div>
        <div class="span3 bottom-description">
          <blockquote>wcm.io is an Open Source project which provides libraries and extensions for AEM-based applications.</blockquote>
        </div>
      </div>
    </div>
  </footer>

  <div class="container subfooter">
    <div class="row">
      <div class="span12">
        <p class="pull-right"><a href="#">Back to top</a></p>
        <p class="copyright">Copyright &copy;2014-2022 <a href="https://wcm.io">wcm.io</a>. All Rights Reserved.</p>
        <p class="version-date"><span class="projectVersion">Version: 1.0.0-SNAPSHOT. </span><span class="publishDate">Last Published: 2022-12-22. </span></p>
      </div>
    </div>
  </div>

  <!-- JavaScript
  ================================================== -->
  <script src="https://wcm.io/js/jquery.min.js"></script>
  <script src="https://wcm.io/js/bootstrap.min.js"></script>
  <script src="https://wcm.io/js/lightbox.min.js"></script>
  <script src="https://wcm.io/js/reflow-scroll.js"></script>
  <script src="https://wcm.io/js/highlight.min.js"></script>


  <script src="https://wcm.io/js/reflow-skin.js"></script>

  </body>
</html>